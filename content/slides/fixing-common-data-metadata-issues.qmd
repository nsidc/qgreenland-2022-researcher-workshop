---
title: "Fixing common data/metadata issues"
subtitle: "QGreenland Researcher Workshop 2023"
background-image: "/_media/DMS_1842643_12758_20180418_18111267_clipped.jpg"
title-slide-attributes:
  data-background-image: "/_media/DMS_1842643_12758_20180418_18111267_clipped.jpg"
---

## What tool should I use?

The best one for the job.

Explore the alternatives available in the ecosystem you want to work!

::: {.notes}
You may recognize this slide from the "data inspection" deck.

Tool selection is context-dependent.

Command-line tools are especially useful for getting a quick answer.

Language-specific tools are good for automations or research code. These
examples use Python because that's what we're most familiar with, but explore
your preferred ecosystem and you'll find equivalents.
:::


## Data scenario #1: Missing metadata

[Link](/content/exercises/data-scenarios/01-missing-metadata)

:::: {.columns}

::: {.column}
![QGreenland screenshot of layer with missing
metadata](/_media/qgreenland_missing_metadata.png)
:::

::: {.column}
```{.text  code-line-numbers="11"}
$ gdalinfo dem_without_metadata.tif
Driver: GTiff/GeoTIFF
Files: dem_without_metadata.tif
Size is 301, 561
Metadata:
  TIFFTAG_XRESOLUTION=1
  TIFFTAG_YRESOLUTION=1
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0,  561.0)
Upper Right (  301.0,    0.0)
Lower Right (  301.0,  561.0)
Center      (  150.5,  280.5)
Band 1 Block=301x6 Type=Float32, ColorInterp=Gray
```
:::

::::

::: {.notes}
The included data file sample (`dem_without_metadata.tif`) is not a real example
of data from NSIDC; it's been modified from the original
([here](https://nsidc.org/data/nsidc-0092/versions/1)) to present a challenge.
:::


## Data scenario #1: Solution

First, make a copy of the data that we will apply edits to:
```{.console}
$ cp dem_without_metadata.tif dem_without_metadata_edited.tif
```

Next, use `gdal_edit.py` to edit, in place, the metadata of
`dem_without_metadata_edited.tif` with the information provided to us in the
dataset landing page.

```{.console}
$ gdal_edit.py \
> -a_srs "+proj=stere +lat_0=90 +lat_ts=71 +lon_0=-39 +x_0=0 +y_0=0 +a=6378137 +rf=298.257024882273 +units=m +no_defs" \
> -a_ullr -802500.000 -597500.000 702500.000 -3402500.000 \
> dem_without_metadata_edited.tif
```

::: {.notes}
`gdal_edit.py` is well-suited for this task: the data is already a `.tif`, which
supports metadata required by tools like `qgis` to correctly locate the data in
space.
:::

## Data scenario #1: All better!



## TODO: Advanced techniques

* _TODO: briefly mention techniques like georegistration, bias correction?_


## What if I can't find a way to fix my data?

Metadata may be undocumented or incorrectly documented; contact data producer!

::: {.callout-warning}
It's possible nobody living knows how to fix the problem!
:::

::: {.notes}
Worst-case scenarios:

* If the metadata is incorrectly documented, there may be no way to "guess" the correct
  configuration. Contacting the originator may be the _only_ way forward. 
* Data originator may have passed away, changed careers, stopped checking their
  email, or forgotten about the data you're working with.
:::
